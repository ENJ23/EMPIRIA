<div class="ticket-page" *ngIf="!loading && tickets.length > 0">

    <!-- Premium Success Animation/Header -->
    <div class="success-header no-print">
        <div class="icon-pulse">
            <span class="material-icons">check_circle</span>
        </div>
        <div>
            <h1>¡Entrada Confirmada!</h1>
            <p>Todo listo para tu experiencia</p>
        </div>
    </div>

    <div class="main-content">
        <!-- Ticket Card - Designed to look like a physical premium ticket -->
        <div class="ticket-card" *ngFor="let ticket of tickets">
            <!-- Left Side: Visuals & Main Info -->
            <div class="ticket-visual">
                <div class="event-image" [style.background-image]="'url(' + ticket.event.imageUrl + ')'">
                    <div class="overlay">
                        <span class="ticket-type">GENERAL ACCESS</span>
                    </div>
                </div>
                <div class="event-main-info">
                    <h2>{{ ticket.event.title }}</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="label">FECHA</span>
                            <span class="value">{{ ticket.event.date | date:'dd MMM yyyy' | uppercase }}</span>
                            <span class="sub-value">{{ ticket.event.date | date:'shortTime' }} HRS</span>
                        </div>
                        <div class="info-item">
                            <span class="label">UBICACIÓN</span>
                            <span class="value">{{ ticket.event.location }}</span>
                        </div>
                    </div>
                </div>
                <!-- Perforated Line Visual -->
                <div class="perforation"></div>
            </div>

            <!-- Right Side (or Bottom on mobile): QR & Validation -->
            <div class="ticket-validation">
                <div class="ticket-header-small">
                    <span class="brand">EMPIRIA</span>
                    <span class="ticket-id">#{{ (ticket._id | uppercase).slice(0, 8) }}</span>
                </div>

                <div class="qr-wrapper">
                    <img [src]="qrCodes[ticket._id]" alt="QR de Entrada" class="qr-code" />
                </div>

                <div class="attendee-info">
                    <p class="attendee-name">{{ ticket.user.name }}</p>
                    <p class="attendee-email">{{ ticket.user.email }}</p>
                </div>

                <div class="ticket-footer-status">
                    <div class="status-pill approved">
                        <span class="material-icons">verified</span> VÁLIDA
                    </div>
                    <div class="price-tag">
                        ${{ ticket.amount }}
                    </div>
                </div>

                <!-- Individual Action (Mobile/Desktop) -->
                <div class="ticket-actions-individual no-print">
                    <button class="btn-icon-small" (click)="downloadQR(ticket)" title="Descargar QR">
                        <span class="material-icons">download</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="actions-panel no-print">
            <button class="btn btn-primary" (click)="printTicket()">
                <span class="material-icons">print</span>
                Imprimir Entradas
            </button>
            <button class="btn btn-text" routerLink="/">
                <span class="material-icons">arrow_back</span>
                Volver al Inicio
            </button>
        </div>

        <div class="advisory-text no-print">
            <p>Presenta el código QR en la entrada directamente desde tu celular o impreso.</p>
        </div>
    </div>
</div>

<div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
</div>